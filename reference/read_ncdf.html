<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read NetCDF into stars object — read_ncdf • stars</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Read NetCDF into stars object — read_ncdf" />
<meta property="og:description" content="Read data from a file (or source) using the NetCDF library directly." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stars</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/stars1.html">1. introduction</a>
    </li>
    <li>
      <a href="../articles/stars2.html">2. stars proxy objects</a>
    </li>
    <li>
      <a href="../articles/stars3.html">3. stars tidyverse methods</a>
    </li>
    <li>
      <a href="../articles/stars4.html">4. stars data model</a>
    </li>
    <li>
      <a href="../articles/stars5.html">5. vector-raster conversions, reprojection, warping</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/stars/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read NetCDF into stars object</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-spatial/stars/blob/master/R/ncdf.R'><code>R/ncdf.R</code></a></small>
    <div class="hidden name"><code>read_ncdf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Read data from a file (or source) using the NetCDF library directly.</p>
    </div>

    <pre class="usage"><span class='fu'>read_ncdf</span>(
  <span class='no'>.x</span>,
  <span class='no'>...</span>,
  <span class='kw'>var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ncsub</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>curvilinear</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(<span class='fl'>0</span>),
  <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-12</span>,
  <span class='kw'>ignore_bounds</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>make_time</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>make_units</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.x</th>
      <td><p>NetCDF file or source</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored</p></td>
    </tr>
    <tr>
      <th>var</th>
      <td><p>variable name or names (they must be on matching grids)</p></td>
    </tr>
    <tr>
      <th>ncsub</th>
      <td><p>matrix of start, count columns (see Details)</p></td>
    </tr>
    <tr>
      <th>curvilinear</th>
      <td><p>length two character named vector with names of variables holding
longitude and latitude values for all raster cells. `stars` attempts to figure out appropriate
curvilinear coordinates if they are not supplied.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>numeric; dimension value increases are considered identical when they differ less than <code>eps</code></p></td>
    </tr>
    <tr>
      <th>ignore_bounds</th>
      <td><p>logical; should bounds values for dimensions, if present, be ignored?</p></td>
    </tr>
    <tr>
      <th>make_time</th>
      <td><p>if <code>TRUE</code> (the default), an atttempt is made to provide a date-time class from the "time" variable</p></td>
    </tr>
    <tr>
      <th>make_units</th>
      <td><p>if <code>TRUE</code> (the default), an attempt is made to set the units property of each variable</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following logic is applied to coordinates. If any coordinate axes have
regularly spaced coordinate variables they are reduced to the
offset/delta form with 'affine = c(0, 0)', otherwise the values of the coordinates
are stored and used to define a rectilinear grid.</p>
<p>If the data has two or more dimensions and the first two are regular
they are nominated as the 'raster' for plotting.</p>
<p>If the <code>curvilinear</code> argument is used it specifies the 2D arrays
containing coordinate values for the first two dimensions of the data read. It is currently
assumed that the coordinates are 2D and that they relate to the first two dimensions in
that order.</p>

<p>If <code>var</code> is not set the first set of variables on a shared grid is used.</p>
<p><code>start</code> and <code>count</code> columns of ncsub must correspond to the variable dimemsion (nrows)
and be valid index using <code><a href='https://rdrr.io/pkg/RNetCDF/man/var.get.nc.html'>var.get.nc</a></code> convention (start is 1-based). If the count value
is <code>NA</code> then all steps are included. Axis order must match that of the variable/s being read.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"nc/reduced.nc"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"stars"</span>)
<span class='fu'>read_ncdf</span>(<span class='no'>f</span>)</div><div class='output co'>#&gt; <span class='message'>no 'var' specified, using sst, anom, err, ice</span></div><div class='output co'>#&gt; <span class='message'>other available variables:</span>
#&gt; <span class='message'> lon, lat, zlev, time</span></div><div class='output co'>#&gt; <span class='message'>No projection information found in nc file. </span>
#&gt; <span class='message'> Coordinate variable units found to be degrees, </span>
#&gt; <span class='message'> assuming WGS84 Lat/Lon.</span></div><div class='output co'>#&gt; stars object with 4 dimensions and 4 attributes
#&gt; attribute(s):
#&gt;     sst [°C]       anom [°C]         err [°C]     ice [percent]  
#&gt;  Min.   :-1.80   Min.   :-7.950   Min.   :0.110   Min.   :0.010  
#&gt;  1st Qu.:-0.03   1st Qu.:-0.580   1st Qu.:0.160   1st Qu.:0.470  
#&gt;  Median :13.65   Median :-0.080   Median :0.270   Median :0.920  
#&gt;  Mean   :12.99   Mean   :-0.185   Mean   :0.263   Mean   :0.718  
#&gt;  3rd Qu.:24.81   3rd Qu.: 0.210   3rd Qu.:0.320   3rd Qu.:0.960  
#&gt;  Max.   :32.97   Max.   : 2.990   Max.   :0.840   Max.   :1.000  
#&gt;  NA's   :4448    NA's   :4449     NA's   :4448    NA's   :13266  
#&gt; dimension(s):
#&gt;      from to.lon offset delta    refsys point         values x/y
#&gt; lon     1    180     -1     2 EPSG:4326    NA           NULL [x]
#&gt; lat     1     90    -90     2 EPSG:4326    NA           NULL [y]
#&gt; zlev    1      1     NA    NA        NA    NA              0    
#&gt; time    1      1     NA    NA   POSIXct    NA 1981-12-31 UTC    </div><div class='input'><span class='fu'>read_ncdf</span>(<span class='no'>f</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"anom"</span>))</div><div class='output co'>#&gt; <span class='message'>No projection information found in nc file. </span>
#&gt; <span class='message'> Coordinate variable units found to be degrees, </span>
#&gt; <span class='message'> assuming WGS84 Lat/Lon.</span></div><div class='output co'>#&gt; stars object with 4 dimensions and 1 attribute
#&gt; attribute(s):
#&gt;    anom [°C]     
#&gt;  Min.   :-7.950  
#&gt;  1st Qu.:-0.580  
#&gt;  Median :-0.080  
#&gt;  Mean   :-0.185  
#&gt;  3rd Qu.: 0.210  
#&gt;  Max.   : 2.990  
#&gt;  NA's   :4449    
#&gt; dimension(s):
#&gt;      from to.lon offset delta    refsys point         values x/y
#&gt; lon     1    180     -1     2 EPSG:4326    NA           NULL [x]
#&gt; lat     1     90    -90     2 EPSG:4326    NA           NULL [y]
#&gt; zlev    1      1     NA    NA        NA    NA              0    
#&gt; time    1      1     NA    NA   POSIXct    NA 1981-12-31 UTC    </div><div class='input'><span class='fu'>read_ncdf</span>(<span class='no'>f</span>, <span class='kw'>ncsub</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>), <span class='kw'>count</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>12</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)))</div><div class='output co'>#&gt; <span class='message'>no 'var' specified, using sst, anom, err, ice</span></div><div class='output co'>#&gt; <span class='message'>other available variables:</span>
#&gt; <span class='message'> lon, lat, zlev, time</span></div><div class='output co'>#&gt; <span class='message'>No projection information found in nc file. </span>
#&gt; <span class='message'> Coordinate variable units found to be degrees, </span>
#&gt; <span class='message'> assuming WGS84 Lat/Lon.</span></div><div class='output co'>#&gt; stars object with 4 dimensions and 4 attributes
#&gt; attribute(s):
#&gt;     sst [°C]        anom [°C]           err [°C]     ice [percent]   
#&gt;  Min.   :-1.390   Min.   :-1.07000   Min.   :0.300   Min.   :0.0100  
#&gt;  1st Qu.:-0.720   1st Qu.:-0.36250   1st Qu.:0.300   1st Qu.:0.1100  
#&gt;  Median :-0.515   Median : 0.19500   Median :0.300   Median :0.1700  
#&gt;  Mean   :-0.534   Mean   : 0.05867   Mean   :0.303   Mean   :0.2094  
#&gt;  3rd Qu.:-0.275   3rd Qu.: 0.55500   3rd Qu.:0.300   3rd Qu.:0.2550  
#&gt;  Max.   : 0.030   Max.   : 0.92000   Max.   :0.320   Max.   :0.5200  
#&gt;  NA's   :90       NA's   :90         NA's   :90      NA's   :104     
#&gt; dimension(s):
#&gt;      from to.lon offset delta    refsys point         values x/y
#&gt; lon     1     10     -1     2 EPSG:4326    NA           NULL [x]
#&gt; lat     1     12    -90     2 EPSG:4326    NA           NULL [y]
#&gt; zlev    1      1     NA    NA        NA    NA              0    
#&gt; time    1      1     NA    NA   POSIXct    NA 1981-12-31 UTC    </div><div class='input'>

<span class='co'>#' precipitation data in a curvilinear NetCDF</span>
<span class='no'>prec_file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"nc/test_stageiv_xyt.nc"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"stars"</span>)
<span class='no'>prec</span> <span class='kw'>=</span> <span class='fu'>read_ncdf</span>(<span class='no'>prec_file</span>, <span class='kw'>curvilinear</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lon"</span>, <span class='st'>"lat"</span>), <span class='kw'>ignore_bounds</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>no 'var' specified, using Total_precipitation_surface_1_Hour_Accumulation</span></div><div class='output co'>#&gt; <span class='message'>other available variables:</span>
#&gt; <span class='message'> time_bounds, lon, lat, time</span></div><div class='output co'>#&gt; <span class='message'>No projection information found in nc file. </span>
#&gt; <span class='message'> Coordinate variable units found to be degrees, </span>
#&gt; <span class='message'> assuming WGS84 Lat/Lon.</span></div><div class='input'>
<span class='co'>##plot(prec) ## gives error about unique breaks</span>
<span class='co'>## remove NAs, zeros, and give a large number</span>
<span class='co'>## of breaks (used for validating in detail)</span>
<span class='no'>qu_0_omit</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>22</span>) {
  <span class='no'>x</span> <span class='kw'>=</span> <span class='kw pkg'>units</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/units/man/drop_units.html'>drop_units</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span>(<span class='no'>x</span>))
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>x</span>[<span class='no'>x</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>], <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>n</span>)))
}
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='no'>prec_slice</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span>(<span class='no'>prec</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='fl'>17</span>, <span class='kw'>along</span> <span class='kw'>=</span> <span class='st'>"time"</span>)
<span class='fu'><a href='plot.html'>plot</a></span>(<span class='no'>prec_slice</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fu'>qu_0_omit</span>(<span class='no'>prec_slice</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='kw'>reset</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='input'><span class='no'>nc</span> <span class='kw'>=</span> <span class='kw pkg'>sf</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sf/man/st_read.html'>read_sf</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"gpkg/nc.gpkg"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sf"</span>), <span class='st'>"nc.gpkg"</span>)
<span class='fu'><a href='plot.html'>plot</a></span>(<span class='fu'>st_geometry</span>(<span class='no'>nc</span>), <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>reset</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='img'><img src='read_ncdf-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


